<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>THE DRILL | LaughCourt‚Ñ¢</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
    --orange: #FF6B00;
    --gold: #FFD700;
    --teal: #00D9A5;
    --pink: #FF1493;
    --purple: #9D4EDD;
    --cyan: #00CED1;
    --dark: #0a0a0f;
    --darker: #050508;
    --card: #111118;
    --text: #FFFFFF;
    --muted: #8892a0;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: 'Outfit', sans-serif;
    background: var(--dark);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
}
.game-container {
    max-width: 500px;
    margin: 0 auto;
    padding: 15px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header */
.header {
    text-align: center;
    padding: 10px 0 15px;
}
.logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.4rem;
    letter-spacing: 3px;
    margin-bottom: 5px;
}
.logo .laugh { color: var(--gold); }
.court-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2.2rem;
    letter-spacing: 4px;
    background: linear-gradient(135deg, var(--purple), var(--pink));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.court-subtitle {
    font-size: 0.75rem;
    color: var(--muted);
    letter-spacing: 2px;
    text-transform: uppercase;
}

/* Stats Bar */
.stats-bar {
    display: flex;
    justify-content: center;
    gap: 20px;
    padding: 12px;
    background: var(--card);
    border-radius: 12px;
    margin-bottom: 15px;
}
.stat {
    text-align: center;
}
.stat-value {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.5rem;
    color: var(--gold);
}
.stat-label {
    font-size: 0.65rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* Sequence Display */
.sequence-display {
    background: linear-gradient(135deg, var(--card), var(--darker));
    border: 2px solid var(--purple);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 15px;
    min-height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    position: relative;
    overflow: hidden;
}
.sequence-display::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, rgba(157,78,221,0.1), transparent);
    pointer-events: none;
}
.sequence-number {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2.5rem;
    color: var(--gold);
    text-shadow: 0 0 20px rgba(255,215,0,0.5);
    animation: numberPop 0.3s ease-out;
    min-width: 50px;
    text-align: center;
}
@keyframes numberPop {
    0% { transform: scale(0); opacity: 0; }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); opacity: 1; }
}
.sequence-prompt {
    font-size: 0.9rem;
    color: var(--muted);
    text-align: center;
}
.sequence-prompt.forward { color: var(--teal); }
.sequence-prompt.backward { color: var(--pink); }

/* Mode & Speed Selection */
.mode-selector {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}
.mode-btn {
    flex: 1;
    padding: 10px;
    border: 2px solid var(--card);
    background: var(--card);
    border-radius: 10px;
    color: var(--muted);
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1rem;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.3s;
}
.mode-btn.active {
    border-color: var(--purple);
    color: var(--text);
    background: linear-gradient(135deg, rgba(157,78,221,0.2), transparent);
}
.mode-btn:hover { border-color: var(--purple); }

.speed-selector {
    display: flex;
    gap: 8px;
    margin-bottom: 15px;
}
.speed-btn {
    flex: 1;
    padding: 8px;
    border: 1px solid var(--card);
    background: var(--card);
    border-radius: 8px;
    color: var(--muted);
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}
.speed-btn.active {
    border-color: var(--gold);
    color: var(--gold);
}
.speed-btn:hover { border-color: var(--gold); }

/* 5x5 Court Grid */
.court-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
    padding: 15px;
    background: linear-gradient(145deg, var(--card), var(--darker));
    border-radius: 16px;
    border: 2px solid rgba(157,78,221,0.3);
    margin-bottom: 15px;
}
.grid-cell {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.4rem;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.15s;
    position: relative;
    overflow: hidden;
}
.grid-cell::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0;
    transition: opacity 0.3s;
}
/* Colorful grid - each row has different color theme */
.grid-cell:nth-child(-n+5) { background: linear-gradient(135deg, #FF6B00, #FF8C42); color: var(--dark); }
.grid-cell:nth-child(n+6):nth-child(-n+10) { background: linear-gradient(135deg, #FFD700, #FFA500); color: var(--dark); }
.grid-cell:nth-child(n+11):nth-child(-n+15) { background: linear-gradient(135deg, #00D9A5, #00CED1); color: var(--dark); }
.grid-cell:nth-child(n+16):nth-child(-n+20) { background: linear-gradient(135deg, #9D4EDD, #7B2CBF); color: var(--text); }
.grid-cell:nth-child(n+21) { background: linear-gradient(135deg, #FF1493, #FF69B4); color: var(--dark); }

.grid-cell:hover { transform: scale(1.05); }
.grid-cell:active { transform: scale(0.95); }
.grid-cell.disabled { opacity: 0.5; pointer-events: none; }
.grid-cell.correct {
    animation: correctPulse 0.4s ease-out;
    box-shadow: 0 0 20px var(--teal);
}
.grid-cell.wrong {
    animation: wrongShake 0.4s ease-out;
    box-shadow: 0 0 20px var(--pink);
}
.grid-cell.hint {
    animation: hintGlow 0.6s ease-in-out;
    box-shadow: 0 0 30px var(--gold);
}
@keyframes correctPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
}
@keyframes wrongShake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}
@keyframes hintGlow {
    0%, 100% { box-shadow: 0 0 10px var(--gold); }
    50% { box-shadow: 0 0 40px var(--gold), 0 0 60px var(--gold); }
}

/* Progress & Tier */
.progress-section {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}
.tier-badge {
    background: linear-gradient(135deg, var(--purple), var(--pink));
    padding: 8px 15px;
    border-radius: 20px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1rem;
    letter-spacing: 2px;
    white-space: nowrap;
}
.progress-bar {
    flex: 1;
    height: 12px;
    background: var(--card);
    border-radius: 6px;
    overflow: hidden;
}
.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--purple), var(--pink));
    border-radius: 6px;
    transition: width 0.3s ease-out;
}

/* Action Button */
.action-btn {
    width: 100%;
    padding: 18px;
    border: none;
    border-radius: 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.3rem;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 10px;
}
.action-btn.start {
    background: linear-gradient(135deg, var(--purple), var(--pink));
    color: var(--text);
}
.action-btn.start:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 25px rgba(157,78,221,0.5);
}
.action-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Laugh Meter */
.laugh-meter {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 10px;
    background: var(--card);
    border-radius: 10px;
}
.laugh-meter-label {
    font-size: 0.8rem;
    color: var(--muted);
}
.laugh-meter-value {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.3rem;
    color: var(--pink);
}

/* Feedback Overlay */
.feedback-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.85);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 100;
}
.feedback-overlay.show { display: flex; }
.feedback-card {
    background: var(--card);
    border-radius: 24px;
    padding: 40px;
    text-align: center;
    max-width: 350px;
    width: 90%;
    animation: slideUp 0.3s ease-out;
}
@keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}
.feedback-emoji {
    font-size: 4rem;
    margin-bottom: 15px;
}
.feedback-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2rem;
    letter-spacing: 3px;
    margin-bottom: 10px;
}
.feedback-title.success { color: var(--teal); }
.feedback-title.fail { color: var(--pink); }
.feedback-message {
    color: var(--muted);
    margin-bottom: 25px;
    line-height: 1.5;
}
.feedback-stats {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-bottom: 25px;
}
.feedback-stat-value {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2rem;
    color: var(--gold);
}
.feedback-stat-label {
    font-size: 0.7rem;
    color: var(--muted);
    text-transform: uppercase;
}
.feedback-btn {
    padding: 14px 40px;
    border: none;
    border-radius: 12px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.1rem;
    letter-spacing: 2px;
    cursor: pointer;
    margin: 5px;
}
.feedback-btn.primary {
    background: linear-gradient(135deg, var(--purple), var(--pink));
    color: var(--text);
}
.feedback-btn.secondary {
    background: var(--darker);
    color: var(--muted);
    border: 1px solid var(--muted);
}

/* Coach Message */
.coach-message {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: linear-gradient(135deg, var(--purple), var(--pink));
    padding: 12px 25px;
    border-radius: 30px;
    font-weight: 600;
    font-size: 0.9rem;
    opacity: 0;
    transition: all 0.4s ease-out;
    z-index: 50;
    white-space: nowrap;
}
.coach-message.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}
</style>
</head>
<body>
<div class="game-container">
    <header class="header">
        <div class="logo"><span class="laugh">LAUGH</span>COURT</div>
        <h1 class="court-name">üèÄ THE DRILL</h1>
        <p class="court-subtitle">Number Sequence Memory</p>
    </header>

    <div class="stats-bar">
        <div class="stat">
            <div class="stat-value" id="currentTier">1</div>
            <div class="stat-label">Tier</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="bestTier">0</div>
            <div class="stat-label">Best</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="totalLaughs">0</div>
            <div class="stat-label">üòÇ</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="streak">0</div>
            <div class="stat-label">üî•</div>
        </div>
    </div>

    <div class="sequence-display" id="sequenceDisplay">
        <span class="sequence-prompt">Select mode & speed, then START DRILL!</span>
    </div>

    <div class="mode-selector">
        <button class="mode-btn active" id="forwardBtn" data-mode="forward">‚û°Ô∏è FORWARD</button>
        <button class="mode-btn" id="backwardBtn" data-mode="backward">‚¨ÖÔ∏è BACKWARD</button>
    </div>

    <div class="speed-selector">
        <button class="speed-btn" id="slowBtn" data-speed="slow">üê¢ SLOW</button>
        <button class="speed-btn active" id="mediumBtn" data-speed="medium">üèÉ MEDIUM</button>
        <button class="speed-btn" id="fastBtn" data-speed="fast">‚ö° FAST</button>
    </div>

    <div class="court-grid" id="courtGrid"></div>

    <div class="progress-section">
        <div class="tier-badge">TIER <span id="tierDisplay">1</span></div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
    </div>

    <button class="action-btn start" id="actionBtn">START DRILL üèÄ</button>

    <div class="laugh-meter">
        <span class="laugh-meter-label">Laugh Meter:</span>
        <span class="laugh-meter-value" id="laughMeter">üòä</span>
    </div>
</div>

<div class="feedback-overlay" id="feedbackOverlay">
    <div class="feedback-card">
        <div class="feedback-emoji" id="feedbackEmoji">üéâ</div>
        <h2 class="feedback-title" id="feedbackTitle">GREAT JOB!</h2>
        <p class="feedback-message" id="feedbackMessage">You completed the drill!</p>
        <div class="feedback-stats">
            <div class="feedback-stat">
                <div class="feedback-stat-value" id="feedbackTier">1</div>
                <div class="feedback-stat-label">Tier</div>
            </div>
            <div class="feedback-stat">
                <div class="feedback-stat-value" id="feedbackLaughs">0</div>
                <div class="feedback-stat-label">üòÇ Earned</div>
            </div>
        </div>
        <button class="feedback-btn primary" id="continueBtn">CONTINUE üèÄ</button>
        <button class="feedback-btn secondary" id="restartBtn">RESTART</button>
    </div>
</div>

<div class="coach-message" id="coachMessage"></div>

<script>
(function() {
    // Game State
    const state = {
        tier: 1,
        bestTier: 0,
        totalLaughs: 0,
        sessionLaughs: 0,
        streak: 0,
        mode: 'forward',
        speed: 'medium',
        sequence: [],
        userSequence: [],
        isPlaying: false,
        isShowingSequence: false,
        circuitsCompleted: 0
    };

    // Speed configs (ms per number)
    const speeds = {
        slow: 1200,
        medium: 800,
        fast: 500
    };

    // Tier = numbers to remember (tier 1 = 2 numbers, tier 10 = 11 numbers)
    const getSequenceLength = (tier) => tier + 1;

    // DOM Elements
    const courtGrid = document.getElementById('courtGrid');
    const sequenceDisplay = document.getElementById('sequenceDisplay');
    const actionBtn = document.getElementById('actionBtn');
    const feedbackOverlay = document.getElementById('feedbackOverlay');
    const coachMessage = document.getElementById('coachMessage');

    // Initialize grid
    function initGrid() {
        courtGrid.innerHTML = '';
        for (let i = 1; i <= 25; i++) {
            const cell = document.createElement('div');
            cell.className = 'grid-cell disabled';
            cell.textContent = i;
            cell.dataset.number = i;
            cell.addEventListener('click', () => handleCellClick(i));
            courtGrid.appendChild(cell);
        }
    }

    // Generate random sequence
    function generateSequence(length) {
        const seq = [];
        const available = Array.from({length: 25}, (_, i) => i + 1);
        for (let i = 0; i < length; i++) {
            const idx = Math.floor(Math.random() * available.length);
            seq.push(available.splice(idx, 1)[0]);
        }
        return seq;
    }

    // Show sequence to user
    async function showSequence() {
        state.isShowingSequence = true;
        actionBtn.disabled = true;
        disableGrid();

        const modeText = state.mode === 'forward' ? '‚û°Ô∏è FORWARD' : '‚¨ÖÔ∏è BACKWARD';
        sequenceDisplay.innerHTML = `<span class="sequence-prompt ${state.mode}">Watch the sequence... ${modeText}</span>`;
        
        await sleep(800);

        for (let i = 0; i < state.sequence.length; i++) {
            const num = state.sequence[i];
            
            // Show number in display
            sequenceDisplay.innerHTML = `<span class="sequence-number">${num}</span>`;
            
            // Highlight cell
            const cell = courtGrid.querySelector(`[data-number="${num}"]`);
            cell.classList.add('hint');
            
            await sleep(speeds[state.speed]);
            
            cell.classList.remove('hint');
            await sleep(200);
        }

        // Ready to input
        const promptText = state.mode === 'forward' 
            ? '‚û°Ô∏è Tap in FORWARD order!' 
            : '‚¨ÖÔ∏è Tap in BACKWARD order!';
        sequenceDisplay.innerHTML = `<span class="sequence-prompt ${state.mode}">${promptText}</span>`;
        
        state.isShowingSequence = false;
        enableGrid();
    }

    // Handle cell click
    function handleCellClick(num) {
        if (state.isShowingSequence || !state.isPlaying) return;

        const cell = courtGrid.querySelector(`[data-number="${num}"]`);
        state.userSequence.push(num);

        // Determine expected sequence based on mode
        const expectedSequence = state.mode === 'forward' 
            ? state.sequence 
            : [...state.sequence].reverse();
        
        const currentIndex = state.userSequence.length - 1;
        const expected = expectedSequence[currentIndex];

        if (num === expected) {
            // Correct!
            cell.classList.add('correct');
            setTimeout(() => cell.classList.remove('correct'), 400);
            
            // Update display to show progress
            updateSequenceProgress();

            if (state.userSequence.length === state.sequence.length) {
                // Completed sequence!
                handleSuccess();
            }
        } else {
            // Wrong!
            cell.classList.add('wrong');
            setTimeout(() => cell.classList.remove('wrong'), 400);
            handleFailure(expected);
        }
    }

    // Update sequence display with progress
    function updateSequenceProgress() {
        const expectedSequence = state.mode === 'forward' 
            ? state.sequence 
            : [...state.sequence].reverse();
        
        let html = '';
        for (let i = 0; i < expectedSequence.length; i++) {
            if (i < state.userSequence.length) {
                html += `<span class="sequence-number" style="color: var(--teal); font-size: 1.8rem;">${state.userSequence[i]}</span>`;
            } else {
                html += `<span class="sequence-number" style="color: var(--muted); font-size: 1.5rem;">?</span>`;
            }
        }
        sequenceDisplay.innerHTML = html;
    }

    // Handle success
    function handleSuccess() {
        state.isPlaying = false;
        disableGrid();
        
        // Calculate laughs
        const baseLaughs = state.tier;
        const speedBonus = state.speed === 'fast' ? 2 : state.speed === 'medium' ? 1 : 0;
        const modeBonus = state.mode === 'backward' ? state.tier : 0;
        const laughsEarned = baseLaughs + speedBonus + modeBonus;
        
        state.sessionLaughs += laughsEarned;
        state.totalLaughs += laughsEarned;
        state.streak++;
        state.circuitsCompleted++;
        
        if (state.tier > state.bestTier) {
            state.bestTier = state.tier;
        }
        
        updateStats();
        
        // Show coach message
        const messages = [
            "PERFECT RECALL! üß†",
            "DRILLED IT! üí™",
            "MEMORY CHAMPION! üèÜ",
            "UNSTOPPABLE! üî•",
            "COACH IS PROUD! üòÇ"
        ];
        showCoachMessage(messages[Math.floor(Math.random() * messages.length)]);
        
        // Update progress
        const progress = (state.circuitsCompleted % 3) / 3 * 100;
        document.getElementById('progressFill').style.width = progress + '%';
        
        // Tier up every 3 circuits
        if (state.circuitsCompleted % 3 === 0 && state.tier < 10) {
            setTimeout(() => {
                showFeedback(true, laughsEarned, true);
            }, 1000);
        } else {
            setTimeout(() => {
                showFeedback(true, laughsEarned, false);
            }, 800);
        }
    }

    // Handle failure
    function handleFailure(expected) {
        state.isPlaying = false;
        disableGrid();
        state.streak = 0;
        
        // Show correct answer
        const cell = courtGrid.querySelector(`[data-number="${expected}"]`);
        cell.classList.add('hint');
        setTimeout(() => cell.classList.remove('hint'), 1000);
        
        showCoachMessage(`That was ${expected}! Keep practicing! üí™`);
        
        updateStats();
        
        setTimeout(() => {
            showFeedback(false, 0, false);
        }, 1500);
    }

    // Show feedback overlay
    function showFeedback(success, laughs, tierUp) {
        const overlay = document.getElementById('feedbackOverlay');
        const emoji = document.getElementById('feedbackEmoji');
        const title = document.getElementById('feedbackTitle');
        const message = document.getElementById('feedbackMessage');
        const tierStat = document.getElementById('feedbackTier');
        const laughsStat = document.getElementById('feedbackLaughs');
        const continueBtn = document.getElementById('continueBtn');
        
        if (success) {
            if (tierUp) {
                emoji.textContent = 'üöÄ';
                title.textContent = 'TIER UP!';
                title.className = 'feedback-title success';
                message.textContent = `Amazing! Moving to Tier ${state.tier + 1}!`;
                state.tier++;
            } else {
                emoji.textContent = 'üòÇ';
                title.textContent = 'DRILLED IT!';
                title.className = 'feedback-title success';
                message.textContent = `${state.circuitsCompleted % 3}/3 circuits to next tier!`;
            }
            continueBtn.textContent = 'NEXT DRILL üèÄ';
        } else {
            emoji.textContent = 'üòÖ';
            title.textContent = 'ALMOST!';
            title.className = 'feedback-title fail';
            message.textContent = 'Shake it off and try again!';
            continueBtn.textContent = 'TRY AGAIN üèÄ';
        }
        
        tierStat.textContent = state.tier;
        laughsStat.textContent = laughs;
        
        overlay.classList.add('show');
        updateStats();
    }

    // Start drill
    function startDrill() {
        state.sequence = generateSequence(getSequenceLength(state.tier));
        state.userSequence = [];
        state.isPlaying = true;
        state.sessionLaughs = 0;
        
        actionBtn.textContent = 'WATCH... üëÄ';
        actionBtn.disabled = true;
        
        showSequence();
    }

    // UI Helpers
    function enableGrid() {
        courtGrid.querySelectorAll('.grid-cell').forEach(cell => {
            cell.classList.remove('disabled');
        });
    }

    function disableGrid() {
        courtGrid.querySelectorAll('.grid-cell').forEach(cell => {
            cell.classList.add('disabled');
        });
    }

    function updateStats() {
        document.getElementById('currentTier').textContent = state.tier;
        document.getElementById('bestTier').textContent = state.bestTier;
        document.getElementById('totalLaughs').textContent = state.totalLaughs;
        document.getElementById('streak').textContent = state.streak;
        document.getElementById('tierDisplay').textContent = state.tier;
        
        // Update laugh meter
        const laughMeter = document.getElementById('laughMeter');
        if (state.streak >= 5) laughMeter.textContent = 'ü§£ü§£ü§£';
        else if (state.streak >= 3) laughMeter.textContent = 'üòÇüòÇ';
        else if (state.streak >= 1) laughMeter.textContent = 'üòÑ';
        else laughMeter.textContent = 'üòä';
    }

    function showCoachMessage(msg) {
        coachMessage.textContent = msg;
        coachMessage.classList.add('show');
        setTimeout(() => coachMessage.classList.remove('show'), 2500);
    }

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Event Listeners
    actionBtn.addEventListener('click', () => {
        if (!state.isPlaying && !state.isShowingSequence) {
            startDrill();
        }
    });

    document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            if (state.isPlaying) return;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            state.mode = btn.dataset.mode;
        });
    });

    document.querySelectorAll('.speed-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            if (state.isPlaying) return;
            document.querySelectorAll('.speed-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            state.speed = btn.dataset.speed;
        });
    });

    document.getElementById('continueBtn').addEventListener('click', () => {
        feedbackOverlay.classList.remove('show');
        actionBtn.textContent = 'START DRILL üèÄ';
        actionBtn.disabled = false;
        sequenceDisplay.innerHTML = `<span class="sequence-prompt">Ready for Tier ${state.tier}!</span>`;
    });

    document.getElementById('restartBtn').addEventListener('click', () => {
        feedbackOverlay.classList.remove('show');
        state.tier = 1;
        state.circuitsCompleted = 0;
        state.streak = 0;
        document.getElementById('progressFill').style.width = '0%';
        actionBtn.textContent = 'START DRILL üèÄ';
        actionBtn.disabled = false;
        sequenceDisplay.innerHTML = `<span class="sequence-prompt">Back to Tier 1 - Let's go!</span>`;
        updateStats();
    });

    // Initialize
    initGrid();
    updateStats();
})();
</script>
</body>
</html>
