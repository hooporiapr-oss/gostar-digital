<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>LaughCourtâ„¢ - Exercise Your Memory. Exercise Your Smile.</title>
<meta name="description" content="LaughCourt - The ONLY laughter-powered memory fitness! 2 games. 10 tiers. $5/month.">
<link rel="icon" type="image/png" href="favicon.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--purple:#6B21A8;--purple-dark:#581C87;--purple-light:#9333EA;--teal:#00D9A5;--gold:#FFD700;--dark:#0a0a0f;--card:#111118;--text:#FFFFFF;--muted:#8892a0}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Outfit',sans-serif;background:var(--dark);color:var(--text);min-height:100vh}
body.es .lang-en{display:none !important}
body.en .lang-es{display:none !important}

/* Language Toggle */
.lang-toggle{display:flex;gap:8px;justify-content:center;padding:20px}
.lang-btn{padding:8px 16px;border:2px solid var(--gold);background:transparent;color:var(--gold);border-radius:20px;font-weight:700;font-size:0.8rem;cursor:pointer;transition:all 0.3s}
.lang-btn.active{background:var(--gold);color:var(--dark)}

/* Header */
.header{text-align:center;padding:20px}
.logo{font-family:'Bebas Neue',sans-serif;font-size:clamp(2.5rem,10vw,4rem);letter-spacing:2px}
.logo .laugh{color:var(--gold)}
.logo .court{color:var(--text)}
.tagline{font-family:'Bebas Neue',sans-serif;font-size:clamp(0.8rem,2.5vw,1.1rem);letter-spacing:3px;color:var(--purple-light);margin-top:5px}

/* Hero */
.hero{text-align:center;padding:30px 20px}
.hero-icon{width:100px;height:100px;border-radius:50%;object-fit:cover;animation:bounce 2s infinite}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.hero-text{font-size:1rem;color:var(--muted);line-height:1.6;max-width:400px;margin:20px auto 0}
.hero-text strong{color:var(--text)}

/* Games */
.games{padding:30px 20px;max-width:700px;margin:0 auto}
.section-title{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;letter-spacing:3px;text-align:center;margin-bottom:20px;color:var(--gold)}
.game-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}
@media(max-width:500px){.game-grid{grid-template-columns:1fr}}
.game-card{background:var(--card);border:2px solid rgba(107,33,168,0.3);border-radius:16px;padding:25px 15px;text-align:center;transition:all 0.3s}
.game-card:hover{border-color:var(--gold);transform:translateY(-3px)}
.game-emoji{font-size:3rem;margin-bottom:10px}
.game-name{font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:2px;color:var(--gold);margin-bottom:8px}
.game-desc{font-size:0.85rem;color:var(--muted);line-height:1.5}

/* Pricing */
.pricing{padding:30px 20px;text-align:center}
.price-box{background:linear-gradient(135deg,rgba(107,33,168,0.2),rgba(255,215,0,0.1));border:3px solid var(--gold);border-radius:20px;padding:30px 20px;max-width:350px;margin:0 auto}
.price-amount{font-family:'Bebas Neue',sans-serif;font-size:3.5rem;color:var(--gold)}
.price-amount span{font-size:1.2rem;color:var(--muted)}
.price-features{list-style:none;margin:20px 0;text-align:left;padding:0 10px}
.price-features li{padding:8px 0;font-size:0.9rem;color:var(--muted);display:flex;align-items:center;gap:10px}
.price-features li::before{content:'âœ“';color:var(--teal);font-weight:bold}
.cta-btn{display:inline-block;padding:18px 50px;font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:3px;background:linear-gradient(135deg,var(--gold),#FFA500);color:var(--dark);border:none;border-radius:50px;cursor:pointer;text-decoration:none;box-shadow:0 8px 30px rgba(255,215,0,0.4);transition:all 0.3s;margin-top:20px}
.cta-btn:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 12px 40px rgba(255,215,0,0.5)}

/* Returning User */
.returning{padding:20px;text-align:center}
.returning-link{color:var(--purple-light);font-size:0.9rem;cursor:pointer;text-decoration:underline}
.returning-link:hover{color:var(--gold)}

/* Footer */
.footer{text-align:center;padding:30px 20px;font-size:0.75rem;color:var(--muted)}
.footer a{color:var(--gold);text-decoration:none}

/* PIN Modal */
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);z-index:100;align-items:center;justify-content:center;padding:20px}
.modal.active{display:flex}
.modal-content{background:var(--card);border:2px solid var(--gold);border-radius:24px;padding:40px 30px;max-width:400px;width:100%;text-align:center;position:relative}
.modal-close{position:absolute;top:15px;right:20px;background:none;border:none;color:var(--muted);font-size:1.5rem;cursor:pointer}
.modal-title{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;letter-spacing:2px;color:var(--gold);margin-bottom:15px}
.modal-text{color:var(--muted);font-size:0.95rem;margin-bottom:20px;line-height:1.5}
.email-input{width:100%;padding:14px 20px;background:var(--dark);border:2px solid rgba(255,255,255,0.2);border-radius:12px;font-family:'Outfit',sans-serif;font-size:1rem;color:var(--text);outline:none;margin-bottom:15px}
.email-input:focus{border-color:var(--gold)}
.modal-btn{width:100%;padding:14px;font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:2px;background:linear-gradient(135deg,var(--gold),#FFA500);color:var(--dark);border:none;border-radius:30px;cursor:pointer;transition:all 0.3s}
.modal-btn:hover{transform:scale(1.02)}
.modal-btn:disabled{opacity:0.5;cursor:not-allowed}

/* PIN Display */
.pin-display{background:linear-gradient(135deg,rgba(107,33,168,0.2),rgba(255,215,0,0.2));border:3px solid var(--gold);border-radius:16px;padding:25px;margin:20px 0}
.pin-label{font-size:0.8rem;color:var(--muted);letter-spacing:1px;margin-bottom:8px}
.pin-value{font-family:'Bebas Neue',sans-serif;font-size:3rem;letter-spacing:12px;color:var(--gold);text-shadow:0 0 20px rgba(255,215,0,0.5)}
.pin-note{font-size:0.8rem;color:var(--teal);margin-top:10px}
.play-btn{margin-top:20px;padding:16px 40px;font-family:'Bebas Neue',sans-serif;font-size:1.2rem;letter-spacing:2px;background:linear-gradient(135deg,var(--teal),#00B894);color:var(--dark);border:none;border-radius:30px;cursor:pointer;transition:all 0.3s}
.play-btn:hover{transform:scale(1.05)}

/* PIN Input */
.pin-input-container{display:flex;gap:10px;justify-content:center;margin:20px 0}
.pin-digit{width:50px;height:60px;background:var(--dark);border:2px solid rgba(255,255,255,0.2);border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:2rem;color:var(--text);text-align:center;outline:none}
.pin-digit:focus{border-color:var(--gold)}

/* Success Animation */
.confetti-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1000;overflow:hidden}
.confetti{position:absolute;width:10px;height:10px;top:-10px;animation:fall 4s linear forwards}
@keyframes fall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}

/* Questions */
.questions{padding:10px 20px;text-align:center}
.questions-link{color:var(--teal);font-size:0.9rem;cursor:pointer}
.questions-link:hover{color:var(--gold)}

/* Chat FAB */
.chat-fab{position:fixed;bottom:25px;right:25px;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,var(--purple),var(--purple-dark));border:3px solid var(--gold);cursor:pointer;box-shadow:0 5px 25px rgba(107,33,168,0.5);z-index:50;display:flex;align-items:center;justify-content:center;transition:all 0.3s;animation:fabPulse 2s infinite}
.chat-fab:hover{transform:scale(1.1)}
.chat-fab img{width:40px;height:40px;border-radius:50%}
@keyframes fabPulse{0%,100%{box-shadow:0 5px 25px rgba(107,33,168,0.5)}50%{box-shadow:0 5px 35px rgba(255,215,0,0.4)}}

/* Chat Modal */
.chat-modal{display:none;position:fixed;bottom:100px;right:25px;width:350px;max-width:calc(100vw - 40px);height:500px;max-height:70vh;background:var(--card);border:2px solid var(--gold);border-radius:20px;z-index:100;flex-direction:column;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.5)}
.chat-modal.active{display:flex}
.chat-header{padding:15px;background:linear-gradient(135deg,rgba(107,33,168,0.3),rgba(255,215,0,0.1));border-bottom:1px solid rgba(255,215,0,0.3);display:flex;align-items:center;gap:12px}
.chat-header img{width:40px;height:40px;border-radius:50%}
.chat-header-info{flex:1}
.chat-header-name{font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:1px;color:var(--gold)}
.chat-header-status{font-size:0.7rem;color:var(--teal)}
.chat-close-btn{background:none;border:none;color:var(--muted);font-size:1.3rem;cursor:pointer}
.chat-body{flex:1;overflow-y:auto;padding:15px;display:flex;flex-direction:column;gap:12px}
.chat-msg{max-width:85%;padding:12px 16px;border-radius:16px;font-size:0.9rem;line-height:1.5;animation:msgIn 0.3s ease}
@keyframes msgIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.chat-msg.bot{background:var(--dark);align-self:flex-start;border-bottom-left-radius:4px}
.chat-msg.bot strong{color:var(--gold)}
.chat-options{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.chat-option{padding:10px 16px;background:rgba(255,215,0,0.1);border:2px solid rgba(255,215,0,0.4);color:var(--gold);border-radius:20px;font-size:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s}
.chat-option:hover{background:rgba(255,215,0,0.2)}
.joke-box{margin-top:10px;padding:10px;background:rgba(255,215,0,0.1);border-left:3px solid var(--gold);border-radius:8px;font-style:italic;color:var(--gold);font-size:0.85rem}
</style>
</head>
<body class="en">
<div class="confetti-container" id="confetti"></div>

<!-- Language Toggle -->
<div class="lang-toggle">
<button class="lang-btn active" data-lang="en">EN</button>
<button class="lang-btn" data-lang="es">ES</button>
</div>

<!-- Header -->
<header class="header">
<div class="logo"><span class="laugh">LAUGH</span><span class="court">COURT</span><sup style="font-size:0.3em">â„¢</sup></div>
<div class="tagline">
<span class="lang-en">EXERCISE YOUR MEMORY. EXERCISE YOUR SMILE.</span>
<span class="lang-es">EJERCITA TU MEMORIA. EJERCITA TU SONRISA.</span>
</div>
</header>

<!-- Hero -->
<section class="hero">
<img src="go_chat.png" alt="Coach GoTrotter" class="hero-icon">
<p class="hero-text">
<span class="lang-en"><strong>2 Games. 10 Tiers.</strong> The ONLY laughter-powered memory fitness platform!</span>
<span class="lang-es"><strong>2 Juegos. 10 Niveles.</strong> Â¡La ÃšNICA plataforma de fitness mental impulsada por risa!</span>
</p>
</section>

<!-- Games -->
<section class="games">
<h2 class="section-title">
<span class="lang-en">ğŸ® YOUR LAUGHTER GAMES</span>
<span class="lang-es">ğŸ® TUS JUEGOS DE RISA</span>
</h2>
<div class="game-grid">
<div class="game-card">
<div class="game-emoji">ğŸ›¤ï¸</div>
<div class="game-name">LAUGH TRAIL</div>
<p class="game-desc">
<span class="lang-en">Watch the path light up â†’ Tap it back! Memory sequence training with laughs.</span>
<span class="lang-es">Â¡Mira el camino iluminarse â†’ RepÃ­telo! Entrenamiento de secuencias con risas.</span>
</p>
</div>
<div class="game-card">
<div class="game-emoji">ğŸ”</div>
<div class="game-name">LAUGH HUNT</div>
<p class="game-desc">
<span class="lang-en">Find hidden words in funny categories. Discovery + attention training.</span>
<span class="lang-es">Encuentra palabras en categorÃ­as graciosas. Descubrimiento + atenciÃ³n.</span>
</p>
</div>
</div>
</section>

<!-- Pricing -->
<section class="pricing">
<div class="price-box">
<div class="price-amount">$5<span>/mo</span></div>
<ul class="price-features">
<li><span class="lang-en">2 brain-boosting games</span><span class="lang-es">2 juegos para el cerebro</span></li>
<li><span class="lang-en">10 progressive tiers</span><span class="lang-es">10 niveles progresivos</span></li>
<li><span class="lang-en">Bilingual (EN/ES)</span><span class="lang-es">BilingÃ¼e (EN/ES)</span></li>
<li><span class="lang-en">Cancel anytime</span><span class="lang-es">Cancela cuando quieras</span></li>
</ul>
<a href="https://buy.stripe.com/9B6bJ2c9i1qy0Qrbqh00005" class="cta-btn">
<span class="lang-en">START LAUGHING! ğŸ˜‚</span>
<span class="lang-es">Â¡A REÃR! ğŸ˜‚</span>
</a>
</div>
</section>

<!-- Returning User -->
<section class="returning">
<span class="returning-link" id="returningBtn">
<span class="lang-en">ğŸ”‘ Already subscribed? Enter your PIN</span>
<span class="lang-es">ğŸ”‘ Â¿Ya suscrito? Ingresa tu PIN</span>
</span>
</section>

<!-- Questions Link -->
<section class="questions">
<span class="questions-link" id="questionsBtn">
<span class="lang-en">â“ Questions? Chat with Coach GoTrotter AI</span>
<span class="lang-es">â“ Â¿Preguntas? Habla con Coach GoTrotter AI</span>
</span>
</section>

<!-- Footer -->
<footer class="footer">
<span class="lang-en">Powered by</span>
<span class="lang-es">Impulsado por</span>
<a href="https://gostar.digital"> GoStar Digital</a> ğŸŒ´
</footer>

<!-- Chat FAB -->
<button class="chat-fab" id="chatFab">
<img src="go_chat.png" alt="Coach">
</button>

<!-- Success Modal (after Stripe payment) -->
<div class="modal" id="successModal">
<div class="modal-content">
<button class="modal-close" id="closeSuccess">Ã—</button>
<div class="modal-title">ğŸ‰ <span class="lang-en">PAYMENT SUCCESSFUL!</span><span class="lang-es">Â¡PAGO EXITOSO!</span></div>
<p class="modal-text">
<span class="lang-en">Enter the email you used at checkout to get your PIN:</span>
<span class="lang-es">Ingresa el email que usaste para obtener tu PIN:</span>
</p>
<input type="email" class="email-input" id="successEmail" placeholder="your@email.com">
<button class="modal-btn" id="successBtn">
<span class="lang-en">GET MY PIN</span>
<span class="lang-es">OBTENER MI PIN</span>
</button>
<div id="pinResult"></div>
</div>
</div>

<!-- Returning User Modal -->
<div class="modal" id="returningModal">
<div class="modal-content">
<button class="modal-close" id="closeReturning">Ã—</button>
<div class="modal-title">ğŸ”‘ <span class="lang-en">WELCOME BACK!</span><span class="lang-es">Â¡BIENVENIDO!</span></div>
<p class="modal-text">
<span class="lang-en">Enter your 4-digit PIN:</span>
<span class="lang-es">Ingresa tu PIN de 4 dÃ­gitos:</span>
</p>
<div class="pin-input-container">
<input type="tel" class="pin-digit" maxlength="1" data-idx="0">
<input type="tel" class="pin-digit" maxlength="1" data-idx="1">
<input type="tel" class="pin-digit" maxlength="1" data-idx="2">
<input type="tel" class="pin-digit" maxlength="1" data-idx="3">
</div>
<button class="modal-btn" id="pinLoginBtn" disabled>
<span class="lang-en">LET'S LAUGH!</span>
<span class="lang-es">Â¡A REÃR!</span>
</button>
<p style="margin-top:15px">
<span class="returning-link" id="forgotPinBtn">
<span class="lang-en">Forgot PIN? Use email</span>
<span class="lang-es">Â¿Olvidaste tu PIN? Usa email</span>
</span>
</p>
<div id="loginResult"></div>
</div>
</div>

<!-- Forgot PIN Modal -->
<div class="modal" id="forgotModal">
<div class="modal-content">
<button class="modal-close" id="closeForgot">Ã—</button>
<div class="modal-title">ğŸ“§ <span class="lang-en">RECOVER PIN</span><span class="lang-es">RECUPERAR PIN</span></div>
<p class="modal-text">
<span class="lang-en">Enter your subscription email:</span>
<span class="lang-es">Ingresa tu email de suscripciÃ³n:</span>
</p>
<input type="email" class="email-input" id="forgotEmail" placeholder="your@email.com">
<button class="modal-btn" id="forgotBtn">
<span class="lang-en">RECOVER PIN</span>
<span class="lang-es">RECUPERAR PIN</span>
</button>
<div id="forgotResult"></div>
</div>
</div>

<!-- Chat Modal -->
<div class="chat-modal" id="chatModal">
<div class="chat-header">
<img src="go_chat.png" alt="Coach">
<div class="chat-header-info">
<div class="chat-header-name">GOTROTTERâ„¢ AI</div>
<div class="chat-header-status">ğŸŸ¢ <span class="lang-en">Ready to help!</span><span class="lang-es">Â¡Listo para ayudar!</span></div>
</div>
<button class="chat-close-btn" id="chatClose">Ã—</button>
</div>
<div class="chat-body" id="chatBody"></div>
</div>

<script>
(function(){
// Language
var lang = localStorage.getItem('lc-lang') || 'en';
function setLang(l) {
    lang = l;
    localStorage.setItem('lc-lang', l);
    document.body.className = l;
    document.querySelectorAll('.lang-btn').forEach(function(b) {
        b.classList.toggle('active', b.dataset.lang === l);
    });
}
setLang(lang);
document.querySelectorAll('.lang-btn').forEach(function(b) {
    b.addEventListener('click', function() { setLang(this.dataset.lang); });
});

// Modals
var successModal = document.getElementById('successModal');
var returningModal = document.getElementById('returningModal');
var forgotModal = document.getElementById('forgotModal');

document.getElementById('returningBtn').onclick = function() { returningModal.classList.add('active'); };
document.getElementById('closeSuccess').onclick = function() { successModal.classList.remove('active'); };
document.getElementById('closeReturning').onclick = function() { returningModal.classList.remove('active'); };
document.getElementById('closeForgot').onclick = function() { forgotModal.classList.remove('active'); };
document.getElementById('forgotPinBtn').onclick = function() { 
    returningModal.classList.remove('active'); 
    forgotModal.classList.add('active'); 
};

// Check URL for success
if (window.location.search.includes('success')) {
    window.history.replaceState({}, '', window.location.pathname);
    successModal.classList.add('active');
    createConfetti();
}

// PIN Input handling
var pinDigits = document.querySelectorAll('.pin-digit');
var pinLoginBtn = document.getElementById('pinLoginBtn');
pinDigits.forEach(function(d, i) {
    d.addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value && i < 3) pinDigits[i + 1].focus();
        checkPinReady();
    });
    d.addEventListener('keydown', function(e) {
        if (e.key === 'Backspace' && !this.value && i > 0) pinDigits[i - 1].focus();
    });
});

function checkPinReady() {
    var pin = '';
    pinDigits.forEach(function(d) { pin += d.value; });
    pinLoginBtn.disabled = pin.length !== 4;
}

// Get PIN by email (after payment)
document.getElementById('successBtn').onclick = function() {
    var email = document.getElementById('successEmail').value.trim().toLowerCase();
    if (!email || !email.includes('@')) { alert('Please enter valid email'); return; }
    this.disabled = true;
    this.textContent = 'Loading...';
    fetch('/api/stripe/status/' + encodeURIComponent(email))
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (d.subscribed && d.pin) {
                showPinSuccess(d.pin, 'pinResult');
            } else {
                document.getElementById('pinResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">No subscription found. Try again.</p>';
            }
            document.getElementById('successBtn').disabled = false;
            document.getElementById('successBtn').innerHTML = '<span class="lang-en">GET MY PIN</span><span class="lang-es">OBTENER MI PIN</span>';
        })
        .catch(function() {
            document.getElementById('pinResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">Connection error.</p>';
            document.getElementById('successBtn').disabled = false;
        });
};

// Login with PIN
pinLoginBtn.onclick = function() {
    var pin = '';
    pinDigits.forEach(function(d) { pin += d.value; });
    this.disabled = true;
    this.textContent = 'Loading...';
    fetch('/api/subscriber/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ pin: pin })
    })
    .then(function(r) { return r.json(); })
    .then(function(d) {
        if (d.success) {
            localStorage.setItem('lc-user', JSON.stringify({ email: d.email, pin: pin }));
            sessionStorage.setItem('lc-pin', pin);
            createConfetti();
            setTimeout(function() { window.location.href = 'laugh-hub.html'; }, 1000);
        } else {
            document.getElementById('loginResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">Invalid PIN.</p>';
            pinLoginBtn.disabled = false;
            pinLoginBtn.innerHTML = '<span class="lang-en">LET\'S LAUGH!</span><span class="lang-es">Â¡A REÃR!</span>';
        }
    })
    .catch(function() {
        document.getElementById('loginResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">Connection error.</p>';
        pinLoginBtn.disabled = false;
    });
};

// Forgot PIN
document.getElementById('forgotBtn').onclick = function() {
    var email = document.getElementById('forgotEmail').value.trim().toLowerCase();
    if (!email || !email.includes('@')) { alert('Please enter valid email'); return; }
    this.disabled = true;
    this.textContent = 'Loading...';
    fetch('/api/stripe/status/' + encodeURIComponent(email))
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (d.subscribed && d.pin) {
                showPinSuccess(d.pin, 'forgotResult');
            } else {
                document.getElementById('forgotResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">No subscription found.</p>';
            }
            document.getElementById('forgotBtn').disabled = false;
            document.getElementById('forgotBtn').innerHTML = '<span class="lang-en">RECOVER PIN</span><span class="lang-es">RECUPERAR PIN</span>';
        })
        .catch(function() {
            document.getElementById('forgotResult').innerHTML = '<p style="color:#FF4757;margin-top:15px">Connection error.</p>';
            document.getElementById('forgotBtn').disabled = false;
        });
};

function showPinSuccess(pin, targetId) {
    createConfetti();
    document.getElementById(targetId).innerHTML = 
        '<div class="pin-display">' +
        '<div class="pin-label">YOUR LAUGH PIN</div>' +
        '<div class="pin-value">' + pin + '</div>' +
        '<div class="pin-note">ğŸ“ Save this PIN!</div>' +
        '</div>' +
        '<button class="play-btn" onclick="goPlay(\'' + pin + '\')">ğŸ˜‚ LET\'S PLAY!</button>';
}

window.goPlay = function(pin) {
    sessionStorage.setItem('lc-pin', pin);
    window.location.href = 'laugh-hub.html';
};

function createConfetti() {
    var container = document.getElementById('confetti');
    var colors = ['#FFD700', '#6B21A8', '#00D9A5', '#3B82F6'];
    for (var i = 0; i < 80; i++) {
        setTimeout(function() {
            var c = document.createElement('div');
            c.className = 'confetti';
            c.style.left = Math.random() * 100 + 'vw';
            c.style.background = colors[Math.floor(Math.random() * colors.length)];
            c.style.animationDuration = (Math.random() * 2 + 3) + 's';
            c.style.width = c.style.height = (Math.random() * 8 + 5) + 'px';
            c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
            container.appendChild(c);
            setTimeout(function() { c.remove(); }, 5000);
        }, i * 30);
    }
}

// FAQ Chat
var chatModal = document.getElementById('chatModal');
var chatBody = document.getElementById('chatBody');
var chatFab = document.getElementById('chatFab');

var jokes = [
    {en:"Why did the brain go to the gym? To work on its THINK-ing muscles! ğŸ’ªğŸ§ ",es:"Â¿Por quÃ© el cerebro fue al gimnasio? Â¡Para trabajar sus mÃºsculos de PENSAR! ğŸ’ªğŸ§ "},
    {en:"I told my memory a joke... it forgot to laugh! ğŸ˜‚",es:"Â¡Le contÃ© un chiste a mi memoria... se le olvidÃ³ reÃ­r! ğŸ˜‚"},
    {en:"My neurons are having a party... want to join? ğŸ‰ğŸ§ ",es:"Mis neuronas estÃ¡n de fiesta... Â¿quieres unirte? ğŸ‰ğŸ§ "},
    {en:"Warning: My jokes may cause uncontrollable smiling! ğŸ˜„",es:"Advertencia: Â¡Mis chistes pueden causar sonrisas incontrolables! ğŸ˜„"},
    {en:"Your brain cells are doing a happy dance right now! ğŸ’ƒğŸ§ ",es:"Â¡Tus cÃ©lulas cerebrales estÃ¡n bailando de alegrÃ­a! ğŸ’ƒğŸ§ "}
];

function getJoke() {
    var j = jokes[Math.floor(Math.random() * jokes.length)];
    return lang === 'es' ? j.es : j.en;
}

function bi(en, es) {
    return '<span class="lang-en">' + en + '</span><span class="lang-es">' + es + '</span>';
}

function addBotMsg(text, options) {
    var msg = document.createElement('div');
    msg.className = 'chat-msg bot';
    var html = text;
    if (options && options.length) {
        html += '<div class="chat-options">';
        options.forEach(function(o) {
            html += '<button class="chat-option" data-action="' + o.action + '">' + bi(o.en, o.es) + '</button>';
        });
        html += '</div>';
    }
    msg.innerHTML = html;
    chatBody.appendChild(msg);
    chatBody.scrollTop = chatBody.scrollHeight;
    msg.querySelectorAll('.chat-option').forEach(function(b) {
        b.addEventListener('click', function() { handleFaq(this.dataset.action); });
    });
}

function addJoke(text) {
    return text + '<div class="joke-box">ğŸ˜‚ ' + getJoke() + '</div>';
}

function openChat() {
    chatModal.classList.add('active');
    if (chatBody.children.length === 0) {
        addBotMsg(addJoke(bi(
            "Hey! ğŸ˜‚ I'm <strong>Coach GoTrotter AI</strong> â€” your Laughter Coach! How can I help?",
            "Â¡Hola! ğŸ˜‚ Soy <strong>Coach GoTrotter AI</strong> â€” Â¡tu Coach de Risa! Â¿CÃ³mo puedo ayudarte?"
        )), [
            {en:'ğŸ§  How does it work?', es:'ğŸ§  Â¿CÃ³mo funciona?', action:'how'},
            {en:'ğŸ‘´ Is it for seniors?', es:'ğŸ‘´ Â¿Es para mayores?', action:'who'},
            {en:'ğŸ˜‚ Why laughter?', es:'ğŸ˜‚ Â¿Por quÃ© risa?', action:'why'},
            {en:'ğŸ’° Pricing?', es:'ğŸ’° Â¿Precio?', action:'price'}
        ]);
    }
}

function handleFaq(action) {
    document.querySelectorAll('.chat-option').forEach(function(b) { b.style.opacity = '0.5'; b.style.pointerEvents = 'none'; });
    
    var responses = {
        how: {
            en: "ğŸ® <strong>HOW IT WORKS</strong><br><br>1ï¸âƒ£ Pick a game (TRAIL or HUNT)<br>2ï¸âƒ£ Complete challenges while giggling<br>3ï¸âƒ£ Progress through 10 tiers<br>4ï¸âƒ£ Track your journey<br><br>Each game is 5-10 minutes. Laugh daily!",
            es: "ğŸ® <strong>CÃ“MO FUNCIONA</strong><br><br>1ï¸âƒ£ Elige un juego (TRAIL o HUNT)<br>2ï¸âƒ£ Completa desafÃ­os mientras te rÃ­es<br>3ï¸âƒ£ Progresa por 10 niveles<br>4ï¸âƒ£ Sigue tu progreso<br><br>Â¡Cada juego es de 5-10 minutos!"
        },
        who: {
            en: "ğŸ‘¥ <strong>FOR EVERYONE!</strong><br><br>âœ… Seniors â€” stay sharp & happy<br>âœ… Rehab patients â€” rebuild with joy<br>âœ… Students â€” boost focus & mood<br>âœ… Anyone â€” exercise brain + smile<br><br>Big buttons. Clear visuals. Bilingual. Easy & fun! ğŸ¯",
            es: "ğŸ‘¥ <strong>Â¡PARA TODOS!</strong><br><br>âœ… Adultos mayores â€” mantente activo<br>âœ… RehabilitaciÃ³n â€” reconstruye con alegrÃ­a<br>âœ… Estudiantes â€” mejora enfoque<br>âœ… Cualquiera â€” ejercita cerebro + sonrisa<br><br>Â¡FÃ¡cil y divertido! ğŸ¯"
        },
        why: {
            en: "ğŸ˜‚ <strong>WHY LAUGHTER?</strong><br><br>ğŸ§ª <strong>SCIENCE SAYS:</strong><br>â€¢ Laughter increases dopamine â†’ better memory<br>â€¢ Reduces cortisol â†’ clearer thinking<br>â€¢ Activates multiple brain regions<br>â€¢ Fights isolation & depression<br><br>It's rehabilitation disguised as JOY! ğŸ’ª",
            es: "ğŸ˜‚ <strong>Â¿POR QUÃ‰ RISA?</strong><br><br>ğŸ§ª <strong>LA CIENCIA DICE:</strong><br>â€¢ La risa aumenta dopamina â†’ mejor memoria<br>â€¢ Reduce cortisol â†’ pensamiento mÃ¡s claro<br>â€¢ Activa mÃºltiples regiones cerebrales<br><br>Â¡Es rehabilitaciÃ³n disfrazada de ALEGRÃA! ğŸ’ª"
        },
        price: {
            en: "ğŸ’° <strong>SIMPLE PRICING</strong><br><br>â€¢ <strong>$5/month</strong> â€” cancel anytime<br>â€¢ 2 games, 10 tiers<br>â€¢ Bilingual (EN/ES)<br><br>Just $5 to start laughing! Click the gold button above! ğŸ˜‚",
            es: "ğŸ’° <strong>PRECIO SIMPLE</strong><br><br>â€¢ <strong>$5/mes</strong> â€” cancela cuando quieras<br>â€¢ 2 juegos, 10 niveles<br>â€¢ BilingÃ¼e (EN/ES)<br><br>Â¡Solo $5 para comenzar! Â¡Haz clic en el botÃ³n dorado! ğŸ˜‚"
        }
    };
    
    setTimeout(function() {
        var r = responses[action];
        addBotMsg(addJoke(bi(r.en, r.es)), [
            {en:'ğŸ§  How it works', es:'ğŸ§  CÃ³mo funciona', action:'how'},
            {en:'ğŸ‘´ Who is it for', es:'ğŸ‘´ Para quiÃ©n es', action:'who'},
            {en:'ğŸ˜‚ Why laughter', es:'ğŸ˜‚ Por quÃ© risa', action:'why'},
            {en:'ğŸ’° Pricing', es:'ğŸ’° Precio', action:'price'}
        ]);
    }, 500);
}

chatFab.onclick = openChat;
document.getElementById('questionsBtn').onclick = openChat;
document.getElementById('chatClose').onclick = function() { chatModal.classList.remove('active'); };
})();
</script>
</body>
</html>
