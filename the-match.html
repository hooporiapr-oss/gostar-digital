<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>THE MATCH | LaughCourt - Where Joy Meets The Game</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{--orange:#FF6B35;--gold:#FFD700;--teal:#00D9A5;--pink:#FF1493;--dark:#0a0a0f;--card:#111118;--text:#FFF;--muted:#888;--border:rgba(255,255,255,0.1)}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden;font-family:'Outfit',sans-serif;background:var(--dark);color:var(--text);touch-action:manipulation;-webkit-tap-highlight-color:transparent;user-select:none}
.mini-nav{position:fixed;top:0;left:0;right:0;background:var(--card);border-bottom:1px solid var(--border);padding-top:env(safe-area-inset-top);z-index:1000}
.nav-row{display:flex;align-items:center;justify-content:space-between;height:50px;padding:0 12px}
.back-btn{padding:8px 12px;background:0;border:1px solid var(--border);color:var(--muted);border-radius:8px;font-size:0.75rem;font-weight:600;text-decoration:none}
.nav-title{font-family:'Bebas Neue',sans-serif;font-size:1.2rem;letter-spacing:2px;color:var(--orange)}
.game-container{width:100%;max-width:420px;height:100dvh;margin:0 auto;padding:5px 10px;padding-top:calc(58px + env(safe-area-inset-top));padding-bottom:max(5px,env(safe-area-inset-bottom));display:flex;flex-direction:column;overflow:hidden}
.stats-bar{display:flex;justify-content:center;gap:12px;padding:5px 8px;background:var(--card);border-radius:8px;margin-bottom:4px;flex-shrink:0}
.stat{text-align:center;min-width:40px}
.stat-value{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:var(--orange);line-height:1}
.stat-label{font-size:0.42rem;color:var(--muted);text-transform:uppercase}
.message-display{background:var(--card);border:2px solid var(--orange);border-radius:8px;padding:7px;margin-bottom:4px;text-align:center;flex-shrink:0;min-height:36px;display:flex;align-items:center;justify-content:center}
.message-text{font-family:'Bebas Neue',sans-serif;font-size:0.9rem;letter-spacing:2px}
.selectors-row{display:flex;gap:6px;margin-bottom:4px;flex-shrink:0}
.selector-group{flex:1;background:var(--card);border-radius:8px;padding:5px}
.selector-group.level-group{flex:1.8}
.selector-label{text-align:center;font-size:0.45rem;color:var(--muted);text-transform:uppercase;margin-bottom:3px}
.selector-options{display:flex;gap:3px}
.selector-options.level-options{flex-wrap:wrap;gap:2px}
.selector-btn{flex:1;min-height:34px;padding:5px 2px;border:2px solid var(--border);background:0;border-radius:6px;color:var(--muted);font-family:'Bebas Neue',sans-serif;font-size:0.85rem;cursor:pointer;display:flex;align-items:center;justify-content:center}
.selector-btn.level-btn{min-height:28px;min-width:28px;flex:0 0 auto;width:calc(20% - 2px);font-size:0.75rem}
.selector-btn.active{border-color:var(--orange);color:var(--orange);background:rgba(255,107,53,0.1)}
.progression-display{display:flex;justify-content:center;align-items:center;gap:10px;padding:6px;background:var(--card);border-radius:8px;margin-bottom:4px;flex-shrink:0}
.progression-label{font-family:'Bebas Neue',sans-serif;font-size:0.7rem;color:var(--muted)}
.progression-stars{display:flex;gap:6px}
.progression-star{font-size:1.3rem;opacity:0.25;transition:all 0.3s}
.progression-star.earned{opacity:1;transform:scale(1.15)}
.court-wrapper{flex:1;display:flex;align-items:center;justify-content:center;min-height:0;overflow:hidden}
.court-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:4px;padding:8px;background:#1a1a24;border-radius:16px;border:3px solid var(--orange);width:min(100%,calc(100dvh - 300px),320px);height:min(100%,calc(100dvh - 300px),320px);min-width:200px;min-height:200px;aspect-ratio:1;position:relative}
.grid-cell{aspect-ratio:1;display:flex;align-items:center;justify-content:center;border-radius:6px;cursor:pointer;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.2);min-width:32px;min-height:32px;transition:all 0.1s;position:relative;z-index:1}
.grid-cell.lit{background:var(--orange)!important;border-color:var(--orange)!important;box-shadow:0 0 25px var(--orange);transform:scale(1.08)}
.grid-cell.correct{background:var(--teal)!important;border-color:var(--teal)!important;box-shadow:0 0 15px var(--teal)}
.grid-cell.missed{background:var(--pink)!important;border-color:var(--pink)!important;box-shadow:0 0 15px var(--pink)}
.cell-num{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;color:var(--text);font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,0.5)}
.division-display{display:flex;justify-content:space-between;align-items:center;padding:5px 10px;background:var(--card);border-radius:8px;margin:4px 0;flex-shrink:0;min-height:34px}
.division-badge{font-family:'Bebas Neue',sans-serif;font-size:0.85rem;color:var(--orange)}
.taps-counter{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:var(--teal)}
.score-display{font-family:'Bebas Neue',sans-serif;font-size:1.05rem;color:var(--orange)}
.action-btn{width:100%;min-height:46px;padding:11px;border:none;border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:1.25rem;letter-spacing:4px;cursor:pointer;background:linear-gradient(135deg,var(--orange),#FF8555);color:var(--text);flex-shrink:0}
.action-btn:disabled{opacity:0.5}
.overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.92);display:none;align-items:center;justify-content:center;z-index:1100;padding:20px}
.overlay.show{display:flex}
.overlay-card{background:var(--card);border:2px solid var(--orange);border-radius:14px;padding:20px;text-align:center;max-width:280px;width:100%}
.overlay-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--orange);margin:10px 0}
.overlay-message{color:var(--muted);margin-bottom:12px}
.overlay-btn{min-height:44px;padding:12px 24px;border:none;border-radius:8px;font-family:'Bebas Neue',sans-serif;font-size:0.9rem;cursor:pointer;background:linear-gradient(135deg,var(--orange),#FF8555);color:var(--text)}
@media(max-height:620px){.court-grid{min-width:180px;min-height:180px;width:min(100%,calc(100dvh - 260px),280px);height:min(100%,calc(100dvh - 260px),280px);gap:3px;padding:6px}.grid-cell{min-width:28px;min-height:28px}.cell-num{font-size:1.4rem}}
@media(max-height:540px){.court-grid{min-width:150px;min-height:150px;gap:2px;padding:5px}.grid-cell{min-width:24px;min-height:24px}.cell-num{font-size:1.2rem}}
</style>
</head>
<body>

<nav class="mini-nav">
<div class="nav-row">
<a href="/dashboard.html" class="back-btn">‚Üê BACK</a>
<div class="nav-title">üéØ THE MATCH</div>
<div style="width:70px"></div>
</div>
</nav>

<div class="game-container">
<div class="stats-bar">
<div class="stat"><div class="stat-value" id="levelDisplay">1</div><div class="stat-label">Level</div></div>
<div class="stat"><div class="stat-value" id="roundDisplay">0</div><div class="stat-label">Round</div></div>
<div class="stat"><div class="stat-value" id="streakDisplay">0</div><div class="stat-label">üî•</div></div>
<div class="stat"><div class="stat-value" id="scoreDisplay">0</div><div class="stat-label">Score</div></div>
</div>
<div class="message-display"><span class="message-text" id="messageText">Select level & GO!</span></div>
<div class="selectors-row">
<div class="selector-group level-group"><div class="selector-label">Level</div><div class="selector-options level-options">
<button class="selector-btn level-btn active" data-level="1">1</button>
<button class="selector-btn level-btn" data-level="2">2</button>
<button class="selector-btn level-btn" data-level="3">3</button>
<button class="selector-btn level-btn" data-level="4">4</button>
<button class="selector-btn level-btn" data-level="5">5</button>
<button class="selector-btn level-btn" data-level="6">6</button>
<button class="selector-btn level-btn" data-level="7">7</button>
<button class="selector-btn level-btn" data-level="8">8</button>
<button class="selector-btn level-btn" data-level="9">9</button>
<button class="selector-btn level-btn" data-level="10">10</button>
</div></div>
<div class="selector-group"><div class="selector-label">Speed</div><div class="selector-options"><button class="selector-btn speed-btn active" data-speed="slow">Slow</button><button class="selector-btn speed-btn" data-speed="med">Med</button><button class="selector-btn speed-btn" data-speed="fast">Fast</button></div></div>
</div>
<div class="progression-display">
<span class="progression-label">LEVEL UP:</span>
<div class="progression-stars">
<span class="progression-star" id="star1">‚≠ê</span>
<span class="progression-star" id="star2">‚≠ê</span>
</div>
</div>
<div class="court-wrapper"><div class="court-grid" id="courtGrid"></div></div>
<div class="division-display"><div class="division-badge" id="divisionBadge">L1 SLOW</div><div class="taps-counter" id="tapsCounter">0/5</div><div class="score-display" id="totalScore">0</div></div>
<button class="action-btn" id="actionBtn">GO</button>
</div>

<div class="overlay" id="levelUpOverlay">
<div class="overlay-card">
<div style="font-size:2.5rem">üéØ</div>
<h2 class="overlay-title">LEVEL UP!</h2>
<p class="overlay-message" id="levelUpMessage"></p>
<button class="overlay-btn" id="levelUpBtn">LET'S GO!</button>
</div>
</div>

<script>
(function(){
    var TOTAL_CELLS=25;
    function getCellCount(level){return level+4;}
    var SPEED_CONFIG={slow:2500,med:2000,fast:1500};
    
    var state={
        level:parseInt(localStorage.getItem('lc-match-level'))||1,
        speed:localStorage.getItem('lc-match-speed')||'slow',
        score:parseInt(localStorage.getItem('lc-match-score'))||0,
        streak:parseInt(localStorage.getItem('lc-match-streak'))||0,
        round:0,
        perfectCount:0,
        sequence:[],
        userTaps:[],
        isPlaying:false,
        canTap:false,
        cells:[]
    };
    if(state.level>10)state.level=10;
    if(state.level<1)state.level=1;

    var courtGrid=document.getElementById('courtGrid');
    var messageText=document.getElementById('messageText');
    var actionBtn=document.getElementById('actionBtn');

    var audioCtx=null;
    function playTone(f,d){
        if(!audioCtx)try{audioCtx=new(window.AudioContext||window.webkitAudioContext)()}catch(e){return}
        try{
            if(audioCtx.state==='suspended')audioCtx.resume();
            var o=audioCtx.createOscillator(),g=audioCtx.createGain();
            o.frequency.value=f;o.connect(g);g.connect(audioCtx.destination);
            g.gain.setValueAtTime(0.2,audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+d);
            o.start();o.stop(audioCtx.currentTime+d+0.05);
        }catch(e){}
    }

    function initCourt(){
        courtGrid.innerHTML='';state.cells=[];
        for(var i=0;i<TOTAL_CELLS;i++){
            var cell=document.createElement('div');
            cell.className='grid-cell';
            cell.dataset.index=i;
            cell.onclick=function(){handleCellTap(parseInt(this.dataset.index));};
            courtGrid.appendChild(cell);
            state.cells.push(cell);
        }
    }

    function updateUI(){
        document.getElementById('levelDisplay').textContent=state.level;
        document.getElementById('roundDisplay').textContent=state.round;
        document.getElementById('streakDisplay').textContent=state.streak;
        document.getElementById('scoreDisplay').textContent=state.score;
        document.getElementById('totalScore').textContent=state.score;
        document.getElementById('divisionBadge').textContent='L'+state.level+' '+state.speed.toUpperCase();
        document.getElementById('tapsCounter').textContent=state.userTaps.length+'/'+getCellCount(state.level);
        document.getElementById('star1').className=state.perfectCount>=1?'progression-star earned':'progression-star';
        document.getElementById('star2').className=state.perfectCount>=2?'progression-star earned':'progression-star';
    }

    function startRound(){
        if(state.isPlaying)return;
        state.isPlaying=true;state.canTap=false;state.round++;
        state.sequence=[];state.userTaps=[];
        updateUI();actionBtn.disabled=true;
        state.cells.forEach(function(c){c.className='grid-cell';c.innerHTML='';});
        messageText.textContent='GET READY...';
        setTimeout(function(){
            messageText.textContent='WATCH THE PATTERN!';
            showPattern();
        },800);
    }

    function showPattern(){
        var count=getCellCount(state.level),available=[];
        for(var i=0;i<TOTAL_CELLS;i++)available.push(i);
        for(var j=0;j<count;j++){
            var idx=Math.floor(Math.random()*available.length);
            state.sequence.push(available[idx]);
            available.splice(idx,1);
        }
        state.sequence.forEach(function(cellIdx,seqNum){
            var cell=state.cells[cellIdx];
            cell.classList.add('lit');
            var num=document.createElement('div');
            num.className='cell-num';
            num.textContent=seqNum+1;
            cell.appendChild(num);
        });
        playTone(523,0.15);
        setTimeout(function(){
            state.cells.forEach(function(c){c.className='grid-cell';c.innerHTML='';});
            state.canTap=true;
            messageText.textContent='TAP IN ORDER!';
        },SPEED_CONFIG[state.speed]);
    }

    function handleCellTap(index){
        if(!state.canTap||!state.isPlaying)return;
        var cell=state.cells[index];
        var expected=state.sequence[state.userTaps.length];
        if(index===expected){
            playTone(660,0.1);
            cell.classList.add('correct');
            state.userTaps.push(index);
            state.score+=20;
            updateUI();
            localStorage.setItem('lc-match-score',state.score);
            if(state.userTaps.length>=state.sequence.length){
                roundComplete(true);
            }
        }else{
            cell.classList.add('missed');
            missedTap();
        }
    }

    function missedTap(){
        state.isPlaying=false;state.canTap=false;
        playTone(200,0.3);
        state.perfectCount=0;state.streak=0;
        localStorage.setItem('lc-match-streak',0);
        updateUI();
        messageText.textContent='WRONG ORDER!';
        setTimeout(finishRound,1500);
    }

    function roundComplete(success){
        state.isPlaying=false;
        if(success){
            playTone(784,0.15);
            state.perfectCount++;state.streak++;
            localStorage.setItem('lc-match-streak',state.streak);
            updateUI();
            messageText.textContent='PERFECT!';
            if(state.perfectCount>=2){
                if(state.level<10){
                    levelUp();
                }else{
                    state.perfectCount=0;
                    updateUI();
                    setTimeout(finishRound,1500);
                }
            }else{
                setTimeout(finishRound,1500);
            }
        }
    }

    function levelUp(){
        state.level++;state.perfectCount=0;
        localStorage.setItem('lc-match-level',state.level);
        updateUI();
        document.getElementById('levelUpMessage').textContent='You are now Level '+state.level+'!';
        document.getElementById('levelUpOverlay').classList.add('show');
    }

    document.getElementById('levelUpBtn').onclick=function(){
        document.getElementById('levelUpOverlay').classList.remove('show');
        finishRound();
    };

    function finishRound(){
        state.isPlaying=false;
        state.cells.forEach(function(c){c.className='grid-cell';c.innerHTML='';});
        messageText.textContent='TAP GO!';
        actionBtn.disabled=false;
    }

    document.querySelectorAll('[data-level]').forEach(function(b){
        b.onclick=function(){
            if(state.isPlaying)return;
            document.querySelectorAll('[data-level]').forEach(function(x){x.classList.remove('active');});
            b.classList.add('active');
            state.level=parseInt(b.dataset.level);
            state.perfectCount=0;
            localStorage.setItem('lc-match-level',state.level);
            updateUI();
        };
    });

    document.querySelectorAll('.speed-btn').forEach(function(b){
        b.onclick=function(){
            if(state.isPlaying)return;
            document.querySelectorAll('.speed-btn').forEach(function(x){x.classList.remove('active');});
            b.classList.add('active');
            state.speed=b.dataset.speed;
            localStorage.setItem('lc-match-speed',state.speed);
            updateUI();
        };
    });

    actionBtn.onclick=startRound;

    function loadSaved(){
        var sl=localStorage.getItem('lc-match-level');
        if(sl){
            state.level=parseInt(sl);
            if(state.level>10)state.level=10;
            if(state.level<1)state.level=1;
            document.querySelectorAll('[data-level]').forEach(function(b){b.classList.remove('active');});
            var lb=document.querySelector('[data-level="'+state.level+'"]');
            if(lb)lb.classList.add('active');
        }
        var ss=localStorage.getItem('lc-match-speed');
        if(ss){
            state.speed=ss;
            document.querySelectorAll('.speed-btn').forEach(function(b){b.classList.remove('active');});
            var sb=document.querySelector('.speed-btn[data-speed="'+state.speed+'"]');
            if(sb)sb.classList.add('active');
        }
    }

    initCourt();loadSaved();updateUI();
})();
</script>
</body>
</html>
